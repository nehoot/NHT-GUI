-- NEHOOTS GUI
-- LocalScript in StarterPlayerScripts

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local hrp = character:WaitForChild("HumanoidRootPart")

local spinConn, rainbowConn, noclipConn, flyConn, fly2Conn = nil,nil,nil,nil,nil
local vflyConn = nil
local isFlying, isFlying2, isNoclip, isVFlying = false, false, false, false
local isAutoRun = false
local autoRunConn = nil

-- ESP state
local espEnabled = false
local xrayEnabled = false
local espConn = nil
local espObjects = {} -- [player] = {billboard, highlight}

player.CharacterAdded:Connect(function(char)
    character = char
    humanoid = char:WaitForChild("Humanoid")
    hrp = char:WaitForChild("HumanoidRootPart")
    if spinConn then spinConn:Disconnect() spinConn = nil end
    if rainbowConn then rainbowConn:Disconnect() rainbowConn = nil end
    if flyConn then flyConn:Disconnect() flyConn = nil end
    if fly2Conn then fly2Conn:Disconnect() fly2Conn = nil end
    if noclipConn then noclipConn:Disconnect() noclipConn = nil end
    if vflyConn then vflyConn:Disconnect() vflyConn = nil end
    if autoRunConn then autoRunConn:Disconnect() autoRunConn = nil end
    isFlying = false; isFlying2 = false; isNoclip = false
    isVFlying = false; isAutoRun = false
end)

-- ========== GUI ==========
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NehootsGui"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = player.PlayerGui

-- NHT open button
local openBtn = Instance.new("TextButton")
openBtn.Size = UDim2.new(0, 52, 0, 52)
openBtn.Position = UDim2.new(0, 10, 0.5, -26)
openBtn.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
openBtn.TextColor3 = Color3.new(1,1,1)
openBtn.Text = "NHT"
openBtn.Font = Enum.Font.GothamBold
openBtn.TextSize = 13
openBtn.Parent = screenGui
Instance.new("UICorner", openBtn).CornerRadius = UDim.new(1, 0)
local ob_s = Instance.new("UIStroke", openBtn)
ob_s.Color = Color3.fromRGB(255,200,0); ob_s.Thickness = 2

local dragging, dragStartPos, btnStartPos = false, nil, nil
openBtn.InputBegan:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then
        dragging=true; dragStartPos=i.Position; btnStartPos=openBtn.Position
    end
end)
openBtn.InputEnded:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then
        dragging=false
    end
end)
UserInputService.InputChanged:Connect(function(i)
    if dragging and (i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch) then
        local d=i.Position-dragStartPos
        openBtn.Position=UDim2.new(btnStartPos.X.Scale,btnStartPos.X.Offset+d.X,btnStartPos.Y.Scale,btnStartPos.Y.Offset+d.Y)
    end
end)

-- ========== MAIN FRAME ==========
local TITLE_H  = 42
local ACC_H    = 34
local GAP      = 5
local BPAD     = 8

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, TITLE_H + GAP + ACC_H + GAP + ACC_H + GAP + ACC_H + GAP + ACC_H + BPAD)
frame.AnchorPoint = Vector2.new(0.5, 0)
frame.Position = UDim2.new(0.5, 0, 0.05, 0)
frame.BackgroundColor3 = Color3.fromRGB(12, 12, 18)
frame.Active = true
frame.Draggable = true
frame.Visible = false
frame.ClipsDescendants = true
frame.Parent = screenGui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 14)
local frame_stroke = Instance.new("UIStroke", frame)
frame_stroke.Color = Color3.fromRGB(255,200,0); frame_stroke.Thickness = 2

-- Title bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1,0,0,TITLE_H)
titleBar.BackgroundColor3 = Color3.fromRGB(15,15,15)
titleBar.Parent = frame
Instance.new("UICorner", titleBar).CornerRadius = UDim.new(0,14)

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1,-100,1,0)
titleLabel.Position = UDim2.new(0,10,0,0)
titleLabel.BackgroundTransparency = 1
titleLabel.TextColor3 = Color3.fromRGB(255,200,0)
titleLabel.Text = "üéÆ NEHOOTS GUI"
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 14
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

local contactBtn = Instance.new("TextButton")
contactBtn.Size = UDim2.new(0,30,0,30); contactBtn.Position = UDim2.new(1,-68,0,6)
contactBtn.BackgroundColor3 = Color3.fromRGB(0,136,204); contactBtn.TextColor3 = Color3.new(1,1,1)
contactBtn.Text = "‚úâ"; contactBtn.Font = Enum.Font.GothamBold; contactBtn.TextSize = 14
contactBtn.Parent = titleBar
Instance.new("UICorner", contactBtn).CornerRadius = UDim.new(1,0)

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0,30,0,30); closeBtn.Position = UDim2.new(1,-34,0,6)
closeBtn.BackgroundColor3 = Color3.fromRGB(200,40,40); closeBtn.TextColor3 = Color3.new(1,1,1)
closeBtn.Text = "‚úï"; closeBtn.Font = Enum.Font.GothamBold; closeBtn.TextSize = 13
closeBtn.Parent = titleBar
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1,0)

-- ========== CONTACT POPUP ==========
local contactPopup = Instance.new("Frame")
contactPopup.Size = UDim2.new(0,240,0,130); contactPopup.Position = UDim2.new(0.5,-120,0.5,-65)
contactPopup.BackgroundColor3 = Color3.fromRGB(12,12,18); contactPopup.Active = true
contactPopup.Draggable = true; contactPopup.Visible = false; contactPopup.ZIndex = 10
contactPopup.Parent = screenGui
Instance.new("UICorner", contactPopup).CornerRadius = UDim.new(0,14)
local cp_s = Instance.new("UIStroke", contactPopup); cp_s.Color = Color3.fromRGB(0,136,204); cp_s.Thickness = 2

local function mkLabel(props)
    local l = Instance.new("TextLabel")
    for k,v in pairs(props) do l[k]=v end
    l.BackgroundTransparency=1; l.ZIndex=10; l.Parent=contactPopup; return l
end
mkLabel({Size=UDim2.new(1,0,0,32),TextColor3=Color3.fromRGB(0,136,204),Text="‚úâ  Contact",Font=Enum.Font.GothamBold,TextSize=14})
local cpDiv=Instance.new("Frame"); cpDiv.Size=UDim2.new(0.9,0,0,1); cpDiv.Position=UDim2.new(0.05,0,0,32)
cpDiv.BackgroundColor3=Color3.fromRGB(0,136,204); cpDiv.BorderSizePixel=0; cpDiv.ZIndex=10; cpDiv.Parent=contactPopup
mkLabel({Size=UDim2.new(1,-20,0,24),Position=UDim2.new(0,10,0,38),TextColor3=Color3.fromRGB(160,160,160),Text="Telegram",Font=Enum.Font.Gotham,TextSize=11,TextXAlignment=Enum.TextXAlignment.Left})
mkLabel({Size=UDim2.new(1,-20,0,26),Position=UDim2.new(0,10,0,58),TextColor3=Color3.new(1,1,1),Text="@void3x",Font=Enum.Font.GothamBold,TextSize=17,TextXAlignment=Enum.TextXAlignment.Left})
local cpClose=Instance.new("TextButton"); cpClose.Size=UDim2.new(0.88,0,0,28); cpClose.Position=UDim2.new(0.06,0,0,92)
cpClose.BackgroundColor3=Color3.fromRGB(200,40,40); cpClose.TextColor3=Color3.new(1,1,1)
cpClose.Text="Close"; cpClose.Font=Enum.Font.GothamBold; cpClose.TextSize=12; cpClose.ZIndex=10; cpClose.Parent=contactPopup
Instance.new("UICorner",cpClose).CornerRadius=UDim.new(0,8)
contactBtn.MouseButton1Click:Connect(function() contactPopup.Visible=not contactPopup.Visible end)
cpClose.MouseButton1Click:Connect(function() contactPopup.Visible=false end)

-- ========== ACCORDION SYSTEM ==========
local accordionStates = {}

local function recalcFrameHeight()
    local h = TITLE_H + GAP
    for _, acc in ipairs(accordionStates) do
        h = h + ACC_H + GAP
        if acc.isOpen then
            h = h + acc.openHeight + GAP
        end
    end
    h = h + BPAD
    TweenService:Create(frame, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
        Size = UDim2.new(0, 300, 0, h)
    }):Play()
end

local currentY = TITLE_H + GAP

local function makeAccordion(labelText, accentColor, panelHeight, buildContents)
    local yPos = currentY
    local accState = {panel=nil, openHeight=panelHeight, isOpen=false}
    table.insert(accordionStates, accState)

    local accBtn = Instance.new("TextButton")
    accBtn.Size = UDim2.new(1,-16,0,ACC_H)
    accBtn.Position = UDim2.new(0,8,0,yPos)
    accBtn.BackgroundColor3 = Color3.fromRGB(22,22,32)
    accBtn.TextColor3 = accentColor
    accBtn.Text = "  "..labelText.."  ‚ñº"
    accBtn.Font = Enum.Font.GothamBold
    accBtn.TextSize = 13
    accBtn.TextXAlignment = Enum.TextXAlignment.Left
    accBtn.AutoButtonColor = false
    accBtn.Parent = frame
    Instance.new("UICorner", accBtn).CornerRadius = UDim.new(0,8)
    local acc_s = Instance.new("UIStroke", accBtn)
    acc_s.Color = accentColor; acc_s.Thickness = 1.5

    local arrow = Instance.new("TextLabel")
    arrow.Size = UDim2.new(0,28,1,0); arrow.Position = UDim2.new(1,-32,0,0)
    arrow.BackgroundTransparency = 1; arrow.TextColor3 = accentColor
    arrow.Text = "‚ñº"; arrow.Font = Enum.Font.GothamBold; arrow.TextSize = 12
    arrow.Parent = accBtn

    local panel = Instance.new("Frame")
    panel.Size = UDim2.new(1,-16,0,0)
    panel.Position = UDim2.new(0,8,0,yPos+ACC_H+GAP)
    panel.BackgroundColor3 = Color3.fromRGB(18,18,26)
    panel.ClipsDescendants = true
    panel.BorderSizePixel = 0
    panel.Parent = frame
    Instance.new("UICorner", panel).CornerRadius = UDim.new(0,8)
    accState.panel = panel

    buildContents(panel)

    currentY = yPos + ACC_H + GAP

    accBtn.MouseButton1Click:Connect(function()
        accState.isOpen = not accState.isOpen
        local a = accState.isOpen and "‚ñ≤" or "‚ñº"
        arrow.Text = a; accBtn.Text = "  "..labelText.."  "..a

        TweenService:Create(panel, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
            Size = UDim2.new(1,-16,0, accState.isOpen and panelHeight or 0)
        }):Play()

        local yRunner = TITLE_H + GAP
        for _, acc in ipairs(accordionStates) do
            yRunner = yRunner + ACC_H + GAP
            if acc.isOpen then
                TweenService:Create(acc.panel, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
                    Position = UDim2.new(0,8,0, yRunner)
                }):Play()
                yRunner = yRunner + acc.openHeight + GAP
            else
                TweenService:Create(acc.panel, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
                    Position = UDim2.new(0,8,0, yRunner)
                }):Play()
            end
        end

        recalcFrameHeight()
    end)

    return panel
end

-- ========== SLIDERS ==========
local sliderValues = {}

local function makeSlider(parent, labelText, minVal, maxVal, defaultVal, index)
    local yOff = (index-1)*36+6
    local c = Instance.new("Frame")
    c.Size=UDim2.new(1,-16,0,30); c.Position=UDim2.new(0,8,0,yOff)
    c.BackgroundTransparency=1; c.Parent=parent

    local lbl=Instance.new("TextLabel"); lbl.Size=UDim2.new(0.58,0,0,14)
    lbl.BackgroundTransparency=1; lbl.TextColor3=Color3.fromRGB(180,180,180)
    lbl.Text=labelText; lbl.Font=Enum.Font.Gotham; lbl.TextSize=11
    lbl.TextXAlignment=Enum.TextXAlignment.Left; lbl.Parent=c

    local vl=Instance.new("TextLabel"); vl.Size=UDim2.new(0.4,0,0,14); vl.Position=UDim2.new(0.6,0,0,0)
    vl.BackgroundTransparency=1; vl.TextColor3=Color3.fromRGB(255,200,0)
    vl.Text=tostring(defaultVal); vl.Font=Enum.Font.GothamBold; vl.TextSize=11
    vl.TextXAlignment=Enum.TextXAlignment.Right; vl.Parent=c

    local track=Instance.new("Frame"); track.Size=UDim2.new(1,0,0,10); track.Position=UDim2.new(0,0,0,18)
    track.BackgroundColor3=Color3.fromRGB(35,35,50); track.BorderSizePixel=0; track.Parent=c
    Instance.new("UICorner",track).CornerRadius=UDim.new(1,0)

    local fill=Instance.new("Frame"); fill.Size=UDim2.new((defaultVal-minVal)/(maxVal-minVal),0,1,0)
    fill.BackgroundColor3=Color3.fromRGB(255,200,0); fill.BorderSizePixel=0; fill.Parent=track
    Instance.new("UICorner",fill).CornerRadius=UDim.new(1,0)

    local knob=Instance.new("Frame"); knob.Size=UDim2.new(0,18,0,18); knob.AnchorPoint=Vector2.new(0.5,0.5)
    knob.Position=UDim2.new((defaultVal-minVal)/(maxVal-minVal),0,0.5,0)
    knob.BackgroundColor3=Color3.new(1,1,1); knob.BorderSizePixel=0; knob.Parent=track
    Instance.new("UICorner",knob).CornerRadius=UDim.new(1,0)

    sliderValues[labelText]=defaultVal
    local sliding=false
    local function upd(x)
        local rel=math.clamp((x-track.AbsolutePosition.X)/track.AbsoluteSize.X,0,1)
        local v=math.floor(minVal+rel*(maxVal-minVal))
        sliderValues[labelText]=v; vl.Text=tostring(v)
        fill.Size=UDim2.new(rel,0,1,0); knob.Position=UDim2.new(rel,0,0.5,0)
    end
    track.InputBegan:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
            sliding=true; upd(i.Position.X)
        end
    end)
    UserInputService.InputChanged:Connect(function(i)
        if sliding and (i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch) then
            upd(i.Position.X)
        end
    end)
    UserInputService.InputEnded:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
            sliding=false
        end
    end)
end

-- ========== SETTINGS ACCORDION ==========
makeAccordion("‚öôÔ∏è  Settings", Color3.fromRGB(255,200,0), 216, function(panel)
    makeSlider(panel,"‚ö° SPEED",       16,200,50, 1)
    makeSlider(panel,"ü¶ò JUMP POWER",  50,300,100,2)
    makeSlider(panel,"üíö HEALTH",      1, 500,100,3)
    makeSlider(panel,"üåÄ SPIN (secs)", 1, 30, 5,  4)
    makeSlider(panel,"‚úàÔ∏è FLY SPEED",   10,200,50, 5)
    makeSlider(panel,"üî≠ FOV",         60,120,120,6)
end)

-- ========== ESP ACCORDION ==========

-- Helper: get a consistent team-based or rainbow color per player
local function getPlayerColor(plr)
    local hue = (math.abs(plr.UserId) % 100) / 100
    return Color3.fromHSV(hue, 0.85, 1)
end

local function cleanESPFor(plr)
    if espObjects[plr] then
        if espObjects[plr].billboard and espObjects[plr].billboard.Parent then
            espObjects[plr].billboard:Destroy()
        end
        if espObjects[plr].highlight and espObjects[plr].highlight.Parent then
            espObjects[plr].highlight:Destroy()
        end
        espObjects[plr] = nil
    end
end

local function buildESPFor(plr)
    if plr == player then return end
    local char = plr.Character
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart")
    local head = char:FindFirstChild("Head")
    if not root or not head then return end

    local col = getPlayerColor(plr)

    -- Billboard GUI above head
    local bb = Instance.new("BillboardGui")
    bb.Name = "NHT_ESP"
    bb.Size = UDim2.new(0, 100, 0, 28)
    bb.StudsOffset = Vector3.new(0, 3.2, 0)
    bb.AlwaysOnTop = true
    bb.Adornee = head
    bb.Parent = head

    local nameTag = Instance.new("TextLabel")
    nameTag.Size = UDim2.new(1,0,0.55,0)
    nameTag.BackgroundTransparency = 1
    nameTag.Text = plr.DisplayName
    nameTag.TextColor3 = col
    nameTag.Font = Enum.Font.GothamBold
    nameTag.TextSize = 13
    nameTag.TextStrokeTransparency = 0
    nameTag.TextStrokeColor3 = Color3.new(0,0,0)
    nameTag.Parent = bb

    local distTag = Instance.new("TextLabel")
    distTag.Size = UDim2.new(1,0,0.45,0)
    distTag.Position = UDim2.new(0,0,0.55,0)
    distTag.BackgroundTransparency = 1
    distTag.Text = "..."
    distTag.TextColor3 = Color3.fromRGB(220,220,220)
    distTag.Font = Enum.Font.Gotham
    distTag.TextSize = 10
    distTag.TextStrokeTransparency = 0
    distTag.TextStrokeColor3 = Color3.new(0,0,0)
    distTag.Parent = bb

    -- Highlight (X-Ray / through walls)
    local hl = Instance.new("SelectionBox")
    hl.Name = "NHT_Highlight"
    hl.Color3 = col
    hl.LineThickness = 0.06
    hl.SurfaceTransparency = xrayEnabled and 0.55 or 1
    hl.SurfaceColor3 = col
    hl.Adornee = char
    hl.Parent = char

    espObjects[plr] = {billboard=bb, highlight=hl, distTag=distTag}
end

local function rebuildAllESP()
    for _, plr in ipairs(Players:GetPlayers()) do
        cleanESPFor(plr)
        if espEnabled then buildESPFor(plr) end
    end
end

-- Update distance labels + xray surface toggle every heartbeat
RunService.Heartbeat:Connect(function()
    if not espEnabled then return end
    for plr, obj in pairs(espObjects) do
        if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and hrp then
            local dist = math.floor((hrp.Position - plr.Character.HumanoidRootPart.Position).Magnitude)
            if obj.distTag then obj.distTag.Text = dist.."st" end
        end
        if obj.highlight then
            obj.highlight.SurfaceTransparency = xrayEnabled and 0.55 or 1
        end
    end
end)

Players.PlayerAdded:Connect(function(plr)
    if espEnabled then
        plr.CharacterAdded:Connect(function()
            task.wait(1)
            cleanESPFor(plr)
            buildESPFor(plr)
        end)
        task.wait(1)
        buildESPFor(plr)
    end
end)
Players.PlayerRemoving:Connect(function(plr)
    cleanESPFor(plr)
end)

makeAccordion("üëÅÔ∏è  ESP / X-Ray", Color3.fromRGB(100,220,255), 136, function(panel)
    -- ESP Toggle row
    local function makeToggleRow(parent, yOff, label, color, onToggle)
        local row = Instance.new("Frame")
        row.Size = UDim2.new(1,-16,0,32); row.Position = UDim2.new(0,8,0,yOff)
        row.BackgroundTransparency = 1; row.Parent = parent

        local lbl = Instance.new("TextLabel")
        lbl.Size = UDim2.new(0.65,0,1,0)
        lbl.BackgroundTransparency = 1
        lbl.TextColor3 = Color3.fromRGB(200,200,200)
        lbl.Text = label; lbl.Font = Enum.Font.Gotham; lbl.TextSize = 12
        lbl.TextXAlignment = Enum.TextXAlignment.Left; lbl.Parent = row

        local togBtn = Instance.new("TextButton")
        togBtn.Size = UDim2.new(0,60,0,24); togBtn.Position = UDim2.new(1,-60,0,4)
        togBtn.BackgroundColor3 = Color3.fromRGB(60,60,70)
        togBtn.TextColor3 = Color3.fromRGB(180,180,180)
        togBtn.Text = "OFF"; togBtn.Font = Enum.Font.GothamBold; togBtn.TextSize = 11
        togBtn.Parent = row
        Instance.new("UICorner", togBtn).CornerRadius = UDim.new(0,6)

        local state = false
        togBtn.MouseButton1Click:Connect(function()
            state = not state
            togBtn.Text = state and "ON" or "OFF"
            togBtn.BackgroundColor3 = state and color or Color3.fromRGB(60,60,70)
            togBtn.TextColor3 = state and Color3.new(1,1,1) or Color3.fromRGB(180,180,180)
            onToggle(state)
        end)
        return togBtn
    end

    makeToggleRow(panel, 6, "üëÅÔ∏è Player ESP (names + dist)", Color3.fromRGB(100,220,255), function(on)
        espEnabled = on
        rebuildAllESP()
        if on then
            for _, plr in ipairs(Players:GetPlayers()) do
                plr.CharacterAdded:Connect(function()
                    task.wait(1)
                    cleanESPFor(plr)
                    buildESPFor(plr)
                end)
            end
        end
    end)

    makeToggleRow(panel, 44, "üîÆ X-Ray Chams (see through walls)", Color3.fromRGB(200,100,255), function(on)
        xrayEnabled = on
        -- update existing highlights immediately
        for _, obj in pairs(espObjects) do
            if obj.highlight then
                obj.highlight.SurfaceTransparency = on and 0.55 or 1
            end
        end
    end)

    makeToggleRow(panel, 82, "üè∑Ô∏è Show Team Colors", Color3.fromRGB(255,180,60), function(on)
        for plr, obj in pairs(espObjects) do
            local col
            if on and plr.Team then
                col = plr.TeamColor.Color
            else
                col = getPlayerColor(plr)
            end
            if obj.billboard then
                for _, lbl in ipairs(obj.billboard:GetDescendants()) do
                    if lbl:IsA("TextLabel") and lbl.Name ~= "distTag" then lbl.TextColor3 = col end
                end
            end
            if obj.highlight then obj.highlight.Color3 = col; obj.highlight.SurfaceColor3 = col end
        end
    end)
end)

-- ========== VEHICLE ACCORDION ==========
makeAccordion("üöó  Vehicle", Color3.fromRGB(255,140,0), 140, function(panel)

    local function makeVBtn(parent, yOff, w, xOff, label, color, func)
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(w,-4,0,30); btn.Position = UDim2.new(xOff,2,0,yOff)
        btn.BackgroundColor3 = color; btn.TextColor3 = Color3.new(1,1,1)
        btn.Text = label; btn.Font = Enum.Font.GothamBold; btn.TextSize = 11
        btn.TextWrapped = true; btn.Parent = parent
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0,7)
        btn.MouseButton1Click:Connect(function()
            local ok,err = pcall(func)
            if not ok then warn("NHT VEH: "..err) end
        end)
        btn.MouseButton1Down:Connect(function()
            TweenService:Create(btn,TweenInfo.new(0.08),{BackgroundColor3=color:Lerp(Color3.new(1,1,1),0.25)}):Play()
        end)
        btn.MouseButton1Up:Connect(function()
            TweenService:Create(btn,TweenInfo.new(0.08),{BackgroundColor3=color}):Play()
        end)
    end

    -- Info label
    local info = Instance.new("TextLabel")
    info.Size = UDim2.new(1,-16,0,18); info.Position = UDim2.new(0,8,0,6)
    info.BackgroundTransparency = 1; info.TextColor3 = Color3.fromRGB(160,160,160)
    info.Text = "Sit in a vehicle seat first, then activate"; info.Font = Enum.Font.Gotham
    info.TextSize = 10; info.TextWrapped = true; info.Parent = panel

    -- VFly toggle
    makeVBtn(panel, 30, 0.5, 0, "‚úàÔ∏è VFly ON/OFF", Color3.fromRGB(0,180,255), function()
        local seat = humanoid.SeatPart
        if not seat then
            warn("NHT: Not in a vehicle seat!") return
        end
        -- Find the root vehicle model
        local vehicleModel = seat
        while vehicleModel.Parent and vehicleModel.Parent ~= workspace do
            vehicleModel = vehicleModel.Parent
        end
        -- Find the primary part or a heavy BasePart
        local vRoot = vehicleModel:IsA("Model") and (vehicleModel.PrimaryPart or vehicleModel:FindFirstChildWhichIsA("BasePart")) or seat

        isVFlying = not isVFlying
        if isVFlying then
            -- Disable vehicle gravity
            local bv = Instance.new("BodyVelocity")
            bv.Name = "VFlyVel"; bv.Velocity = Vector3.zero
            bv.MaxForce = Vector3.new(1e6,1e6,1e6); bv.Parent = vRoot
            local bg = Instance.new("BodyGyro")
            bg.Name = "VFlyGyro"; bg.D = 200
            bg.MaxTorque = Vector3.new(1e6,1e6,1e6); bg.Parent = vRoot

            vflyConn = RunService.Heartbeat:Connect(function()
                if not isVFlying then
                    vflyConn:Disconnect()
                    local v=vRoot:FindFirstChild("VFlyVel") if v then v:Destroy() end
                    local g=vRoot:FindFirstChild("VFlyGyro") if g then g:Destroy() end
                    return
                end
                local cam = workspace.CurrentCamera
                local speed = sliderValues["‚úàÔ∏è FLY SPEED"] or 60
                local d = Vector3.zero
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then d += cam.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then d -= cam.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then d -= cam.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then d += cam.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then d += Vector3.new(0,1,0) end
                if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then d -= Vector3.new(0,1,0) end
                bv.Velocity = d.Magnitude > 0 and d.Unit * speed or Vector3.zero
                bg.CFrame = cam.CFrame
            end)
        else
            if vflyConn then vflyConn:Disconnect() vflyConn = nil end
            local v=vRoot:FindFirstChild("VFlyVel") if v then v:Destroy() end
            local g=vRoot:FindFirstChild("VFlyGyro") if g then g:Destroy() end
        end
    end)

    -- VBoost: slam forward velocity
    makeVBtn(panel, 30, 0.5, 0.5, "üöÄ VBoost", Color3.fromRGB(255,80,0), function()
        local seat = humanoid.SeatPart
        if not seat then warn("NHT: Not in a vehicle seat!") return end
        local vehicleModel = seat
        while vehicleModel.Parent and vehicleModel.Parent ~= workspace do
            vehicleModel = vehicleModel.Parent
        end
        local vRoot = vehicleModel:IsA("Model") and (vehicleModel.PrimaryPart or vehicleModel:FindFirstChildWhichIsA("BasePart")) or seat
        local bv = Instance.new("BodyVelocity")
        bv.Velocity = workspace.CurrentCamera.CFrame.LookVector * (sliderValues["‚úàÔ∏è FLY SPEED"] or 80) * 2
        bv.MaxForce = Vector3.new(1e6,1e6,1e6); bv.Parent = vRoot
        game:GetService("Debris"):AddItem(bv, 0.25)
    end)

    -- VFloat: anti gravity for vehicle
    makeVBtn(panel, 68, 0.5, 0, "üåä VFloat", Color3.fromRGB(0,160,200), function()
        local seat = humanoid.SeatPart
        if not seat then warn("NHT: Not in a vehicle seat!") return end
        local vehicleModel = seat
        while vehicleModel.Parent and vehicleModel.Parent ~= workspace do
            vehicleModel = vehicleModel.Parent
        end
        local vRoot = vehicleModel:IsA("Model") and (vehicleModel.PrimaryPart or vehicleModel:FindFirstChildWhichIsA("BasePart")) or seat
        local bv = Instance.new("BodyVelocity")
        bv.Velocity = Vector3.new(0, 60, 0)
        bv.MaxForce = Vector3.new(0,1e6,0); bv.Parent = vRoot
        game:GetService("Debris"):AddItem(bv, 1.2)
    end)

    -- VNoclip: disable collision on all vehicle parts
    makeVBtn(panel, 68, 0.5, 0.5, "üëª VNoclip", Color3.fromRGB(150,0,200), function()
        local seat = humanoid.SeatPart
        if not seat then warn("NHT: Not in a vehicle seat!") return end
        local vehicleModel = seat
        while vehicleModel.Parent and vehicleModel.Parent ~= workspace do
            vehicleModel = vehicleModel.Parent
        end
        for _, part in ipairs(vehicleModel:GetDescendants()) do
            if part:IsA("BasePart") then part.CanCollide = not part.CanCollide end
        end
    end)

    -- Exit vehicle
    makeVBtn(panel, 106, 1, 0, "üö™ Exit Seat", Color3.fromRGB(80,80,80), function()
        humanoid.Sit = false
    end)
end)

-- ========== COMMANDS ==========
local commands = {
    {"‚ö° Speed",   Color3.fromRGB(0,120,200),   function() humanoid.WalkSpeed=sliderValues["‚ö° SPEED"] or 50 end},
    {"ü¶ò Jump",    Color3.fromRGB(100,0,200),   function() humanoid.JumpPower=sliderValues["ü¶ò JUMP POWER"] or 100 end},
    {"üîÑ Reset",   Color3.fromRGB(80,80,80),    function()
        humanoid.WalkSpeed=16; humanoid.JumpPower=50
        humanoid.MaxHealth=100; humanoid.Health=100
        workspace.CurrentCamera.FieldOfView=70
    end},
    {"‚úàÔ∏è Fly",     Color3.fromRGB(0,180,255),   function()
        isFlying=not isFlying
        if isFlying then
            local bv=Instance.new("BodyVelocity"); bv.Name="FlyVelocity"; bv.Velocity=Vector3.zero
            bv.MaxForce=Vector3.new(1e5,1e5,1e5); bv.Parent=hrp
            local bg=Instance.new("BodyGyro"); bg.Name="FlyGyro"
            bg.MaxTorque=Vector3.new(1e5,1e5,1e5); bg.D=100; bg.Parent=hrp
            humanoid.PlatformStand=true
            flyConn=RunService.Heartbeat:Connect(function()
                if not isFlying then flyConn:Disconnect() return end
                local cam=workspace.CurrentCamera; local speed=sliderValues["‚úàÔ∏è FLY SPEED"] or 50
                local d=Vector3.zero
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then d+=cam.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then d-=cam.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then d-=cam.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then d+=cam.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then d+=Vector3.new(0,1,0) end
                if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then d-=Vector3.new(0,1,0) end
                bv.Velocity=d.Magnitude>0 and d.Unit*speed or Vector3.zero; bg.CFrame=cam.CFrame
            end)
        else
            humanoid.PlatformStand=false
            local bv=hrp:FindFirstChild("FlyVelocity") if bv then bv:Destroy() end
            local bg=hrp:FindFirstChild("FlyGyro") if bg then bg:Destroy() end
            if flyConn then flyConn:Disconnect() flyConn=nil end
        end
    end},
    {"üõ∏ Fly 2",   Color3.fromRGB(0,220,180),   function()
        isFlying2=not isFlying2
        if isFlying2 then
            humanoid.PlatformStand=false
            local att=Instance.new("Attachment"); att.Name="Fly2Att"; att.Parent=hrp
            local vf=Instance.new("VectorForce"); vf.Name="Fly2Force"; vf.Attachment0=att
            vf.Force=Vector3.new(0,workspace.Gravity*hrp.AssemblyMass,0)
            vf.RelativeTo=Enum.ActuatorRelativeTo.World; vf.Parent=hrp
            fly2Conn=RunService.Heartbeat:Connect(function()
                if not isFlying2 then fly2Conn:Disconnect() return end
                local cam=workspace.CurrentCamera; local speed=sliderValues["‚úàÔ∏è FLY SPEED"] or 50
                local d=Vector3.zero
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then d+=cam.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then d-=cam.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then d-=cam.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then d+=cam.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then d+=Vector3.new(0,1,0) end
                if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then d-=Vector3.new(0,1,0) end
                hrp.AssemblyLinearVelocity=d.Magnitude>0 and d.Unit*speed or Vector3.zero
                vf.Force=Vector3.new(0,workspace.Gravity*hrp.AssemblyMass,0)
            end)
        else
            local att=hrp:FindFirstChild("Fly2Att") if att then att:Destroy() end
            local vf=hrp:FindFirstChild("Fly2Force") if vf then vf:Destroy() end
            if fly2Conn then fly2Conn:Disconnect() fly2Conn=nil end
        end
    end},
    {"üòá God",     Color3.fromRGB(210,170,0),   function() humanoid.MaxHealth=math.huge; humanoid.Health=math.huge end},
    {"üíö Heal",    Color3.fromRGB(0,170,0),     function()
        local hp=sliderValues["üíö HEALTH"] or 100; humanoid.MaxHealth=hp; humanoid.Health=hp
    end},
    {"üíÄ Kill",    Color3.fromRGB(180,0,0),     function() humanoid.Health=0 end},
    {"üê≠ Tiny",    Color3.fromRGB(80,200,80),   function() character:ScaleTo(0.3) end},
    {"ü¶ñ Giant",   Color3.fromRGB(200,80,80),   function() character:ScaleTo(3) end},
    {"üìè Normal",  Color3.fromRGB(100,100,100), function() character:ScaleTo(1) end},
    {"üåÄ Spin",    Color3.fromRGB(60,180,255),  function()
        if spinConn then spinConn:Disconnect() spinConn=nil return end
        local t,dur=0,sliderValues["üåÄ SPIN (secs)"] or 5
        spinConn=RunService.Heartbeat:Connect(function(dt)
            t+=dt
            if hrp then hrp.CFrame=hrp.CFrame*CFrame.Angles(0,math.rad(10),0) end
            if t>dur then spinConn:Disconnect() spinConn=nil end
        end)
    end},
    {"üåà Rainbow", Color3.fromRGB(255,100,200), function()
        if rainbowConn then rainbowConn:Disconnect() rainbowConn=nil return end
        local t=0
        rainbowConn=RunService.Heartbeat:Connect(function(dt)
            t+=dt
            local c=Color3.fromHSV(t%1,1,1)
            for _,p in ipairs(character:GetDescendants()) do
                if p:IsA("BasePart") and p.Name~="HumanoidRootPart" then p.Color=c end
            end
            if t>10 then rainbowConn:Disconnect() rainbowConn=nil end
        end)
    end},
    {"üöÄ Fling",   Color3.fromRGB(255,60,60),   function()
        local bv=Instance.new("BodyVelocity")
        bv.Velocity=Vector3.new(math.random(-300,300),math.random(400,800),math.random(-300,300))
        bv.MaxForce=Vector3.new(1e5,1e5,1e5); bv.Parent=hrp
        game:GetService("Debris"):AddItem(bv,0.1)
    end},
    {"üëª Noclip",  Color3.fromRGB(150,0,150),   function()
        isNoclip=not isNoclip
        if isNoclip then
            noclipConn=RunService.Stepped:Connect(function()
                for _,p in ipairs(character:GetDescendants()) do
                    if p:IsA("BasePart") then p.CanCollide=false end
                end
            end)
        else
            if noclipConn then noclipConn:Disconnect() noclipConn=nil end
            for _,p in ipairs(character:GetDescendants()) do
                if p:IsA("BasePart") then p.CanCollide=true end
            end
        end
    end},
    {"üî≠ Zoom",    Color3.fromRGB(0,160,100),   function() workspace.CurrentCamera.FieldOfView=sliderValues["üî≠ FOV"] or 120 end},
    {"üëÅÔ∏è Invis",   Color3.fromRGB(60,60,60),    function()
        for _,p in ipairs(character:GetDescendants()) do
            if p:IsA("BasePart") then p.Transparency=p.Transparency==1 and 0 or 1 end
        end
    end},
    {"üí• Explode", Color3.fromRGB(255,120,0),   function()
        local e=Instance.new("Explosion"); e.Position=hrp.Position
        e.BlastRadius=10; e.BlastPressure=0; e.Parent=workspace
    end},
    {"üåô Float",   Color3.fromRGB(80,80,180),   function()
        local bv=Instance.new("BodyVelocity")
        bv.Velocity=Vector3.new(0,sliderValues["‚úàÔ∏è FLY SPEED"] or 30,0)
        bv.MaxForce=Vector3.new(0,1e5,0); bv.Parent=hrp
        game:GetService("Debris"):AddItem(bv,1)
    end},
    -- ===== NEW AVATAR/MISC COMMANDS =====
    {"üèÉ AutoRun", Color3.fromRGB(0,200,100),   function()
        isAutoRun = not isAutoRun
        if isAutoRun then
            autoRunConn = RunService.Heartbeat:Connect(function()
                if humanoid then
                    humanoid:Move(Vector3.new(0,0,-1), false)
                end
            end)
        else
            if autoRunConn then autoRunConn:Disconnect() autoRunConn = nil end
        end
    end},
    {"üéØ ToSpawn", Color3.fromRGB(0,180,120),   function()
        -- Teleport to spawn location
        local spawn = workspace:FindFirstChildOfClass("SpawnLocation")
        if spawn then
            hrp.CFrame = spawn.CFrame + Vector3.new(0,5,0)
        else
            hrp.CFrame = CFrame.new(0,10,0)
        end
    end},
    {"üß≤ Pull",    Color3.fromRGB(180,0,180),   function()
        -- Pull yourself toward where the camera is looking
        local cam = workspace.CurrentCamera
        hrp.CFrame = hrp.CFrame + cam.CFrame.LookVector * 20
    end},
    {"üßä Freeze",  Color3.fromRGB(80,180,220),  function()
        hrp.Anchored = not hrp.Anchored
    end},
    {"üé≠ Clone",   Color3.fromRGB(120,60,180),  function()
        -- Spawns a visual dummy clone at your position
        local clone = character:Clone()
        clone.Parent = workspace
        for _, p in ipairs(clone:GetDescendants()) do
            if p:IsA("Script") or p:IsA("LocalScript") then p:Destroy() end
        end
        local ch = clone:FindFirstChildOfClass("Humanoid")
        if ch then ch.Health = 0 end
        game:GetService("Debris"):AddItem(clone, 8)
    end},
    {"üíÉ Dance",   Color3.fromRGB(255,80,180),  function()
        -- Force an emote by playing the dance animation
        local anim = Instance.new("Animation")
        anim.AnimationId = "rbxassetid://507771019" -- R15 Dance
        local track = humanoid:LoadAnimation(anim)
        track:Play()
        game:GetService("Debris"):AddItem(anim, 5)
    end},
    {"ü§∏ Flip",    Color3.fromRGB(255,160,0),   function()
        -- Backflip velocity burst
        local bv = Instance.new("BodyVelocity")
        local fwd = hrp.CFrame.LookVector
        bv.Velocity = Vector3.new(fwd.X*30, 60, fwd.Z*30)
        bv.MaxForce = Vector3.new(1e5,1e5,1e5); bv.Parent = hrp
        game:GetService("Debris"):AddItem(bv, 0.3)
    end},
    {"üè† ToOrigin",Color3.fromRGB(100,140,80),  function()
        hrp.CFrame = CFrame.new(0, 50, 0)
    end},
    {"‚ö´ Black",   Color3.fromRGB(30,30,30),    function()
        for _,p in ipairs(character:GetDescendants()) do
            if p:IsA("BasePart") and p.Name~="HumanoidRootPart" then
                p.Color = Color3.fromRGB(10,10,10)
            end
        end
    end},
    {"‚¨ú White",   Color3.fromRGB(200,200,200), function()
        for _,p in ipairs(character:GetDescendants()) do
            if p:IsA("BasePart") and p.Name~="HumanoidRootPart" then
                p.Color = Color3.fromRGB(255,255,255)
            end
        end
    end},
}

-- 4 columns
local COLS = 4
local BTN_H = 44
local BTN_ROWS = math.ceil(#commands / COLS)
local BTN_PANEL_H = BTN_ROWS * (BTN_H + 4) + 8

makeAccordion("üéÆ  Commands", Color3.fromRGB(0,200,120), BTN_PANEL_H, function(panel)
    local sf = Instance.new("ScrollingFrame")
    sf.Size = UDim2.new(1,0,1,0)
    sf.BackgroundTransparency = 1
    sf.ScrollBarThickness = 3
    sf.ScrollBarImageColor3 = Color3.fromRGB(0,200,120)
    sf.ScrollingDirection = Enum.ScrollingDirection.Y
    sf.CanvasSize = UDim2.new(0,0,0,0)
    sf.Parent = panel

    local layout = Instance.new("UIGridLayout")
    layout.CellSize = UDim2.new(0.235, -4, 0, BTN_H)
    layout.CellPadding = UDim2.new(0, 4, 0, 4)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    layout.Parent = sf

    local function updateCanvas()
        sf.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 8)
    end
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvas)

    for _, cmdData in ipairs(commands) do
        local lbl, col, func = cmdData[1], cmdData[2], cmdData[3]
        local btn = Instance.new("TextButton")
        btn.BackgroundColor3 = col
        btn.TextColor3 = Color3.new(1,1,1)
        btn.Text = lbl
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 9
        btn.TextWrapped = true
        btn.Parent = sf
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
        btn.MouseButton1Click:Connect(function()
            local ok,err = pcall(func)
            if not ok then warn("NEHOOTS: "..err) end
        end)
        btn.MouseButton1Down:Connect(function()
            TweenService:Create(btn,TweenInfo.new(0.08),{BackgroundColor3=col:Lerp(Color3.new(1,1,1),0.25)}):Play()
        end)
        btn.MouseButton1Up:Connect(function()
            TweenService:Create(btn,TweenInfo.new(0.08),{BackgroundColor3=col}):Play()
        end)
    end

    task.defer(updateCanvas)
end)

-- ========== TOGGLE ==========
local isOpen = false
openBtn.MouseButton1Click:Connect(function()
    isOpen = not isOpen; frame.Visible = isOpen
end)
closeBtn.MouseButton1Click:Connect(function()
    isOpen = false; frame.Visible = false
end)
